---
title: "ETC5521 Assignment 1"
subtitle: "Analysis of global mobile and fixed telephone usage"
team: brolga
author:
  - Hanchen Wang 
  - Jiaying Zhang 
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2:
    toc: yes
    toc_float: yes
bibliography: reference.bib
biblio-style: authoryear-comp
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.align = "center")
library(dplyr)
library(readr)
library(tidyverse)
library(naniar)
library(rgdal)
library(leaflet)
library(RColorBrewer)
library(ggplot2)
library(gganimate)
library(gifski)
library(plotly)
library(gridExtra)
```

```{r rawData, include = FALSE}
landline <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-11-10/landline.csv')
mobile <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-11-10/mobile.csv')
```
# Introduction and motivation

It has been 45 years since the first landline telephone was invented in 1876. The telephone has changed a lot from how it works to how it looks. Today, mobile technology has spread rapidly around the globe and it is estimated that more than 5 billion people have mobile devices, and over half of these connections are smartphones. 

“Digital connectivity plays a critical role in bettering lives, as it opens the door to unprecedented knowledge, employment and financial opportunities for billions of people worldwide,” said ITU Secretary-General Houlin Zhao. Because the telephone plays a crucial role in our life, we think it is valuable to analyze it.

This analysis is based on information about mobile and landline phones collected by the @ITU -International Telecommunication Union and would like to analyze the phone subscription trend, percentage and other factors.

Specially: 

1.What is the trend in subscription of phone and landline worldwide between 1990 and 2017?

2.What was the growth rate of the subscription of mobile phones in each country from 2015 to 2017 and what was the proportion of the subscription of phone and landline in 2017?

3.What is the regression relationship between phone subscriptions and other variables? 

# Data description

The datasets are downloaded from the Github repository of [Tidy Tuesday](https://github.com/rfordatascience/tidytuesday/tree/master/data/2020/2020-11-10). @Tidy-Tuesday is a weekly data project aimed at the R ecosystem and this report will use datasets adopted by it on November 10, 2020.

There are two datasets provided in the repository and all of them came from an article-"Technology Adoption" which written by @owidtechnologyadoption on 2017 [OurWorldInData.org](https://ourworldindata.org/technology-adoption). 

@Tidy-Tuesday only made a few changes to the original data and already can get relatively clean data that can be used for analysis, mainly by matching the time of several original data, screening the data from 1990 to 2017, and adding the corresponding continent of each country.

## Fixed(landline) telephone subscriptions vs GDP per capita  (`landline.csv`)

The dataset about Fixed(landline) telephone subscriptions vs GDP per capita also originated from "Technology Adoption". It published by [@Worldbank – World Development Indicators](http://data.worldbank.org/data-catalog/world-development-indicators) and collected by [@ITU - International Telecommunication Union](https://www.itu.int/en/ITU-D/Statistics/Pages/publications/wtid.aspx). The dataset cover the data about fixed telephone subscriptions and GPD per capita in each country during **1960** and **2017**.

Fixed telephone subscriptions refers to the sum of active number of analogue fixed telephone lines, voice-over-IP (VoIP) subscriptions, fixed wireless local loop (WLL) subscriptions, ISDN voice-channel equivalents and fixed public payphones.

### Structure of `landline.csv`
This dataset has `r nrow(landline)` number of observations and `r ncol(landline)` number of variables. The name, type and description of each variable in `landline.csv` can be found in the data dictionary below.

|variable                           |class     |description |
|:----------------------------------|:---------|:-----------|
|entity                             |character |Country         |
|code                               |character | Country code |
|year                               |double    | Year |
|total_pop |double    | Gapminder total population |
|gdp_per_cap                        |double    | GDP per capita, PPP (constant 2011 international $) |
|landline_subs                      |double    | Fixed telephone subscriptions (per 100 people)|
|continent                          |character | Continent |

### Collection methods
Data on fixed telephone lines are derived using administrative data that countries (usually the regulatory telecommunication authority or the Ministry in charge of telecommunications) regularly, and at least annually, collect from telecommunications operators. 

Data for this indicator are readily available for approximately 90 percent of countries, either through ITU's World Telecommunication Indicators questionnaires or from official information available on the Ministry or Regulator's website. For the rest, information can be aggregated through operators' data (mainly through annual reports) and complemented by market research reports.

### Data Limitation

- Discrepancies between global and national figures may arise when countries use a different definition than the one used by ITU.Data are usually not adjusted but discrepancies in the definition, reference year or the break in comparability in between years are noted in a data note. For this reason, data are not always strictly comparable. Missing values are estimated by ITU.

```{r missing-value1, fig.cap="Visualise the missing value in landline data", fig.align= "center"}
landline %>%
  vis_miss(sort_miss = TRUE)
```

- From Figure \@ref(fig:missing-value1), we can see that there are 4 variables that have missing values. Among them, there are many null values in `gdp_per_cap` and `landline_subs`, which may have come influence on the results of statistical analysis.
- This data only covers the period from 1990 to 2017. If researchers want to keep up to date with the last few years, they need to look at other data as well.


## Mobilephone subscriptions vs GDP per capita  (`mobile.csv`)
The dataset about Mobilephone subscriptions vs GDP per capita originated from an article-"Technology Adoption". This dataset was published by [@Worldbank – World Development Indicators](http://data.worldbank.org/data-catalog/world-development-indicators) and collected by [@ITU - International Telecommunication Union](https://www.itu.int/en/ITU-D/Statistics/Pages/publications/wtid.aspx). The dataset cover the data about mobilephone subscriptions and GPD per capita in each country from **1960** to **2017**.

### Structure of `mobile.csv`
This dataset has `r nrow(mobile)` number of observations and `r ncol(mobile)` number of variables. The name, type and description of each variable in `mobile.csv` can be found in the data dictionary below.



|variable          |class     |description |
|:-----------------|:---------|:-----------|
|entity            |character | Country |
|code              |character | Country code |
|year              |double    | Year |
|total_pop         |double    | Gapminder total population |
|gdp_per_cap       |double    | GDP per capita, PPP (constant 2011 international $) |
|mobile_subs       |double    | Fixed mobile subscriptions (per 100 people) |
|continent         |character | Continent |


Mobile cellular telephone subscriptions are subscriptions to a public mobile telephone service that provide access to the PSTN using cellular technology. The indicator includes (and is split into) the number of postpaid subscriptions, and the number of active prepaid accounts (i.e. that have been used during the last three months). The indicator applies to all mobile cellular subscriptions that offer voice communications. It excludes subscriptions via data cards or USB modems, subscriptions to public mobile data services, private trunked mobile radio, telepoint, radio paging and telemetry services.

### Collection methods
Data on mobile cellular subscribers are derived using administrative data that countries (usually the regulatory telecommunication authority or the Ministry in charge of telecommunications) regularly, and at least annually, collect from telecommunications operators.

Data for this indicator are readily available for approximately 90 percent of countries, either through ITU's World Telecommunication Indicators questionnaires or from official information available on the Ministry or Regulator's website. For the rest, information can be aggregated through operators' data (mainly through annual reports) and complemented by market research reports.

### Data Limitation
- Discrepancies between global and national figures may arise when countries use a different definition than the one used by ITU. Data are usually not adjusted but discrepancies in the definition, reference year or the break in comparability in between years are noted in a data note. For this reason, data are not always strictly comparable. Missing values are estimated by ITU.


```{r missing-value2, fig.cap="Visualise the missing value in mobile data", fig.align= "center"}
mobile %>%
  vis_miss(sort_miss = TRUE)
```

- From Figure \@ref(fig:missing-value2), we can see that there are 4 variables that have missing values. Among them, there are many null values in `gdp_per_cap` , `total_pop`and `mocile_subs`, which may have some influence on the results of statistical analysis.  
- This data only covers the period from 1990 to 2017. If researchers want to keep up to date with the last few years, they need to look at other data as well.


# Analysis and findings

## What is the trend in subscription of phone and landline worldwide between 1990 and 2017?

## What was the growth rate of the subscription of mobile phones in each country from 2013 to 2017 and what was the proportion of the subscription of phone and landline from 2000?

### What was the growth rate of the subscription of mobile phones in each country from 2013 to 2017?
```{r q2datagrow}
q2_datause <- mobile%>% 
  select(entity, year, mobile_subs) %>% 
  filter(year %in% c(2015, 2017)) %>% 
  mutate(year = as.character(year)) %>% 
  mutate(year = recode(year, "2015" = "mobile2015", "2017" = "mobile2017"))
q2_data <- q2_datause %>% 
pivot_wider(id_cols = entity,  
                     names_from = year, 
                     values_from = mobile_subs) %>% 
  na.omit() %>% 
  mutate(growmobilerate = (mobile2017- mobile2015)/mobile2015) %>% select(entity, growmobilerate)
```


```{r q2mapdownload}
q2_world_spdf <- readOGR( 
  dsn= paste0(getwd(),"/DATA/world_shape_file/") , 
  layer="TM_WORLD_BORDERS_SIMPL-0.3",
  verbose=FALSE
)
```
```{r q2mapcolor, include = FALSE}
mypalette <- colorNumeric( palette="viridis", domain=q2_data$growmobilerate, na.color="transparent")
mypalette(c(45,43))
```
```{r q2maptext}
mytext <- paste(
    "Country: ", q2_world_spdf@data$NAME,"<br/>", 
    "Growth_rate: ", round(q2_data$growmobilerate, 2), 
    sep="") %>%
  lapply(htmltools::HTML)
```

```{r q2growmap, fig.cap= "Growth rate of the mobile subscription in each country during 2013 and 2017"}
leaflet(q2_world_spdf) %>% 
  addTiles()  %>% 
  setView( lat=10, lng=0 , zoom=2) %>%
  addPolygons( 
    fillColor = ~mypalette(q2_data$growmobilerate), 
    stroke=TRUE, 
    fillOpacity = 0.9, 
    color="white", 
    weight=0.3,
    label = mytext,
    labelOptions = labelOptions( 
      style = list("font-weight" = "normal", padding = "3px 8px"), 
      textsize = "13px", 
      direction = "auto"
    )
  ) %>%
addLegend( pal=mypalette, values=q2_data$growmobilerate, opacity=0.9, title = "Growth rate", position = "bottomleft" )

```
(Put mouse on each country you can see the detail about country names and the mobilephone subscription 3 years growthrate of them.)



### What was the proportion of the subscription of phone and landline from 2000?
```{r q2datapro}
q2_landpick <- landline %>% select(
 entity, year, total_pop, landline_subs, continent)
q2_mobilepick <- mobile  %>%  select(
  entity, year, mobile_subs) %>%
rename(
mobilecountry = entity,
mobileyear = year) 
q2_datapro <- q2_landpick %>% 
  left_join(
  q2_mobilepick, by = c("entity" = "mobilecountry", "year"= "mobileyear")) %>% 
  filter(year>1999)
```

```{r animasub, fig.cap= "Compare proportion of the subscription of phone and landline from 2000 to 2017"}
  proanimation <- 
  q2_datapro%>% 
  ggplot( aes(x = landline_subs, y = mobile_subs, 
           size = total_pop, color = continent)) +
  geom_point() +
  theme_bw() +
  labs(title = 'Year: {round(frame_time)}', 
       x = 'landline subscription(per 100 people)', 
       y = 'mobile subscription(per 100 people)') +
  transition_time(year)+
  ease_aes('linear')

animate(plot = proanimation,
    render = gifski_renderer(),
    duration = 18,
    fps = 20)

anim_save("proanimate.gif")
```



```{r compare1, fig.cap= "Proportion of the subscription of phone and landline in 2000 and 2017"}
q2_p <- q2_datapro %>%
  filter(year %in% c(2000, 2017)) %>% 
  ggplot( aes(landline_subs, mobile_subs, 
           size = total_pop, color = continent)) +
  geom_point() +
  theme_bw()+ 
  facet_grid(~ year) +
  theme(legend.position = 'none')
ggplotly()
```







## What is the regression relationship between phone subscriptions and other variables?





[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 

# References
@PRC
@WBD
@R-dplyr
@R-readr
@R-tidyverse
@R-naniar

